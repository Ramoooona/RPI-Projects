# Data Cleaning for Title of Contacts
Title <- read.csv("C:/RPI/Spring 2016/BA Capstone/Title123.csv")

Title$board <- 0
Title$board[grepl('Board',ignore.case=TRUE, Title$Title)]<-1

Title$chief <- 0
Title$chief[grepl('CAO', Title$Title)]<-1
Title$chief[grepl('CCO', Title$Title)]<-1
Title$chief[grepl('CFO', Title$Title)]<-1
Title$chief[grepl('CEO', Title$Title)]<-1
Title$chief[grepl('CIO', Title$Title)]<-1
Title$chief[grepl('CKO', Title$Title)]<-1
Title$chief[grepl('CLO', Title$Title)]<-1
Title$chief[grepl('CMO', Title$Title)]<-1
Title$chief[grepl('CNO', Title$Title)]<-1
Title$chief[grepl('COO', Title$Title)]<-1
Title$chief[grepl('CPO', Title$Title)]<-1
Title$chief[grepl('CQO', Title$Title)]<-1
Title$chief[grepl('CRO', Title$Title)]<-1
Title$chief[grepl('CSO', Title$Title)]<-1
Title$chief[grepl('CTO', Title$Title)]<-1
Title$chief[grepl('chief', ignore.case=TRUE,Title$Title)]<-1
Title$chief[grepl('president', ignore.case=TRUE,Title$Title)]<-1

Title$director <- 0
Title$director[grepl('dir', ignore.case=TRUE,Title$Title)]<-1
Title$director[grepl('manag', ignore.case=TRUE,Title$Title)]<-1

Title$head <- 0
Title$head[grepl('head', ignore.case=TRUE,Title$Title)]<-1
Title$head[grepl('lead', ignore.case=TRUE,Title$Title)]<-1

Title$consultant <- 0
Title$consultant[grepl('consul', ignore.case=TRUE,Title$Title)]<-1

Title$business <- 0
Title$business[grepl('marketing', ignore.case=TRUE,Title$Title)]<-1
Title$business[grepl('sales', ignore.case=TRUE,Title$Title)]<-1

Title$student <- 0
Title$student[grepl('student', ignore.case=TRUE,Title$Title)]<-1

Title$technical <- 0
Title$technical[grepl('info', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('sys', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('IT', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('tech', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('data', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('software', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('developer', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('arch', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('analy', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('engineer', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('app', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('solution', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('virtual', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('visual', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('digi', ignore.case=TRUE,Title$Title)]<-1
Title$technical[grepl('cloud', ignore.case=TRUE,Title$Title)]<-1

write.csv(Title, file = "title135.csv")


# Data Cleaning for Country & Company
# Opportunity company name
company <- read.csv("C:/Users/Ramona/Desktop/company name.csv")
colnames(company) <- c("id","size","name")

# To lower case, remove special characters and space
company$name2 <- lapply(company$name, FUN=tolower)
company$name2 <- lapply(company$name2, FUN=function(x) gsub("[^[:alnum:]///' ]", "", x))
company$name2 <- lapply(company$name2, FUN=function(x) gsub(" ", "", x))

# Count unique
x <- unique(company$name2)

# Lead company name
lead <- read.csv("C:/Users/Ramona/Desktop/Lead Data for RPI project--work.csv")
colnames(lead) <- c("id","title","name","won","lost")
lead$name2 <- lapply(lead$name, FUN=tolower)
lead$name2 <- lapply(lead$name2, FUN=function(x) gsub("[^[:alnum:]///' ]", "", x))
lead$name2 <- lapply(lead$name2, FUN=function(x) gsub(" ", "", x))
lead$name2 <- lapply(lead$name2, FUN=function(x) gsub("'", "", x))

# Export data
lead[]<-lapply(lead,function(x) if(is.list(x)) unlist(x))
write.csv(lead, file="C:/Users/Ramona/Desktop/LeadCompany.csv",row.names=F)

company[]<-lapply(company,function(x) if(is.list(x)) unlist(x))
write.csv(company, file="C:/Users/Ramona/Desktop/OpporCompany.csv",row.names=F)

# Opportunity country 
country1 <- read.csv("C:/Users/Ramona/Desktop/country1.csv")
country1$Country[grepl('United states',country1$Country,ignore.case = TRUE)]<-"USA"
country1$Country[grepl('US',country1$Country,ignore.case = TRUE)]<-"USA"
country1$Country[grepl('kingdom',country1$Country,ignore.case = TRUE)]<-"UK"
country1$Country[grepl('^$',country1$Country)]<-"USA"
country1$Country <- lapply(country1$Country,FUN=function(x) gsub(" ", "", x))

country1[]<-lapply(country1,function(x) if(is.list(x)) unlist(x))
write.csv(country1, file="C:/Users/Ramona/Desktop/OpporCountry.csv",row.names=F)

# Lead country
leadcountry <- read.csv("C:/Users/Ramona/Desktop/leadcountry.csv")
leadcountry$Country[grepl('United states',leadcountry$Country,ignore.case = TRUE)]<-"USA"
leadcountry$Country[grepl('US',leadcountry$Country,ignore.case = TRUE)]<-"USA"
leadcountry$Country[grepl('kingdom',leadcountry$Country,ignore.case = TRUE)]<-"UK"
leadcountry$Country[grepl('brita',leadcountry$Country,ignore.case = TRUE)]<-"UK"
leadcountry$Country[grepl('England',leadcountry$Country,ignore.case = TRUE)]<-"UK"
leadcountry$Country[grepl('Germa',leadcountry$Country,ignore.case = TRUE)]<-"Germany"
leadcountry$Country[grepl('ca',leadcountry$Country,ignore.case = TRUE)]<-"Canada"
leadcountry$Country[grepl('^$',leadcountry$Country)]<-"USA"
leadcountry$Country <- lapply(leadcountry$Country,FUN=function(x) gsub(" ", "", x))

leadcountry[]<-lapply(leadcountry,function(x) if(is.list(x)) unlist(x))
write.csv(leadcountry,file="C:/Users/Ramona/Desktop/Lead-Country.csv",row.names=F)

# Campaign company name and country
campaign <- read.csv("C:/Users/Ramona/Desktop/campaign.csv")
colnames(campaign) <- c("cid","lid","title","name","Country")

# Company name
campaign$name <- lapply(campaign$name, FUN=tolower)
campaign$name <- lapply(campaign$name, FUN=function(x) gsub("[^[:alnum:]///' ]", "", x))
campaign$name <- lapply(campaign$name, FUN=function(x) gsub(" ", "", x))
campaign$name <- lapply(campaign$name, FUN=function(x) gsub("'", "", x))

# Country
campaign$Country[grepl('United states',campaign$Country,ignore.case = TRUE)]<-"USA"
campaign$Country[grepl('US',campaign$Country,ignore.case = TRUE)]<-"USA"
campaign$Country[grepl('kingdom',campaign$Country,ignore.case = TRUE)]<-"UK"
campaign$Country[grepl('brita',campaign$Country,ignore.case = TRUE)]<-"UK"
campaign$Country[grepl('England',campaign$Country,ignore.case = TRUE)]<-"UK"
campaign$Country[grepl('Germa',campaign$Country,ignore.case = TRUE)]<-"Germany"
campaign$Country[grepl('ca',campaign$Country,ignore.case = TRUE)]<-"Canada"
campaign$Country[grepl('^$',campaign$Country)]<-"USA"
campaign$Country <- lapply(campaign$Country,FUN=function(x) gsub(" ", "", x))

# Export data
campaign[]<-lapply(campaign,function(x) if(is.list(x)) unlist(x))
write.csv(campaign,file="C:/Users/Ramona/Desktop/Campaign1.csv",row.names=F)
